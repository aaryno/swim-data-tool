# v0.3.0 - Classify Command Implementation Plan

**Goal:** Implement swim classification logic to categorize unattached swims

**Status:** Planning → In Progress

---

## Overview

Swimmers often have "Unattached" swims in their career data. These need to be classified:

1. **Probationary Swims** - Swims BEFORE joining the team (should count for records)
2. **Ford Unattached** - Swims AFTER being on team but listed as unattached (college, time trials, etc.)

---

## Features to Implement

### 1. Classify Unattached Command

```bash
swim-data-tool classify unattached
```

**What it does:**
- Reads all swimmer CSVs from `data/raw/swimmers/`
- Identifies swims where Team is "Unattached" or similar
- Determines first date swimmer joined team (first affiliated swim)
- Classifies unattached swims:
  - Before join date → Probationary
  - After join date → Ford Unattached (or team name)
- Saves classified swims to:
  - `data/processed/unattached/probationary/swimmer-name-personkey.csv`
  - `data/processed/unattached/ford-unattached/swimmer-name-personkey.csv`

### 2. Classification Logic

Key questions to answer:
1. What date did swimmer join team? (first affiliated swim)
2. Which swims are "unattached"?
   - Team == "Unattached"
   - Team == "" (empty)
   - Team is different from configured team
3. Date comparison: swim date vs join date

### 3. Output Format

Same CSV format as input, but filtered to just unattached swims with added metadata.

---

## Implementation Phases

### Phase 1: Research & Understanding ✅
- [x] Review ford implementation of classification
- [ ] Understand date formats from API
- [ ] Determine team name matching logic

### Phase 2: Core Classification Logic
- [ ] Create ClassifyCommand class
- [ ] Implement swimmer CSV reading
- [ ] Implement join date detection
- [ ] Implement unattached swim detection
- [ ] Implement date-based classification

### Phase 3: CLI Integration
- [ ] Add classify command group to CLI
- [ ] Add unattached subcommand
- [ ] Add progress tracking
- [ ] Add summary statistics

### Phase 4: Testing & Documentation
- [ ] Add tests for classification logic
- [ ] Update documentation
- [ ] Manual testing with real data

---

## Technical Considerations

### Date Handling

From API, dates come as strings like "11/19/2017". Need to:
- Parse to datetime objects
- Compare dates reliably
- Handle missing dates

### Team Name Matching

Team names from .env:
- `USA_SWIMMING_TEAM_CODE` (e.g., "AZ FORD")
- `USA_SWIMMING_TEAM_NAMES` (comma-separated list)

Need to match against actual team names in data, which might vary.

### Data Structure

Input CSV columns (from API):
- SwimTime, Name, Age, Event, LSC, Team, Meet, SwimDate, PersonKey, etc.

Classification adds:
- ClassificationType: "probationary" or "ford-unattached"

---

## Questions to Resolve

1. Should we process ALL swimmers or just ones with unattached swims?
2. How to handle swimmers with NO team swims (all unattached)?
3. Should we create a combined CSV with all classifications?
4. What about swimmers who left team and came back?

---

## Research from Ford Project

Need to look at:
- `scripts/classify_unattached_swims.py` or similar
- How join date is determined
- Edge cases handled

---

**Created:** 2025-10-07  
**Target Release:** v0.3.0
